
%% ABABIO GODFRED OPOKU and VARUN
function [elk] = godfred_varun_estiff (A, Izz, Iyy, J, Ayy, Azz, E, v, L)

%computing the contribution from the shear deformation
G = E/(2*(1+v));

n1 = (E*Iyy)/(Azz*G);  %used for shear deformation of stiffness values in the Iyy direction
n2 = (E*Izz)/(Ayy*G);  %used for shear deformation of stiffness values in the Izz direction

%incorprating shear deformation into the stiffness coefficient
k6 = 1/(2*(L^2/12+n2));  
K6 = 1/(2*(L^2/12+n1));  
k4 = (L^2/3+n2)/(L^3/12+n2*L);   
K4 = (L^2/3+n1)/(L^3/12+n1*L);   
k2 = (L^2/6-n2)/(L*(L^2/12+n2)); 
K2 = (L^2/6-n1)/(L*(L^2/12+n1)); 
k12 = 1/(L*((L^2/12)+n2)); 
K12 = 1/(L*((L^2/12)+n1)); 
t = J/(2*L*(1+v)); % torsion
elk = E*[A/L,0,0,0,0,0,-A/L,0,0,0,0,0;...
    0,k12*Izz,0,0,0,k6*Izz,0,-k12*Izz,0,0,0,k6*Izz;...
    0,0,K12*Iyy,0,-K6*Iyy,0,0,0,-K12*Iyy,0,-K6*Iyy,0;...
    0,0,0,t,0,0,0,0,0,-t,0,0;...
    0,0,-K6*Iyy,0,K4*Iyy,0,0,0,K6*Iyy,0,K2*Iyy,0;...
    0,k6*Izz,0,0,0,k4*Izz,0,-k6*Izz,0,0,0,k2*Izz;...
    -A/L,0,0,0,0,0,A/L,0,0,0,0,0;...
    0,-k12*Izz,0,0,0,-k6*Izz,0,k12*Izz,0,0,0,-k6*Izz;...
    0,0,-K12*Iyy,0,K6*Iyy,0,0,0,K12*Iyy,0,K6*Iyy,0;...
    0,0,0,-t,0,0,0,0,0,t,0,0;...
    0,0,-K6*Iyy,0,K2*Iyy,0,0,0,K6*Iyy,0,K4*Iyy,0;...
    0,k6*Izz,0,0,0,k2*Izz,0,-k6*Izz,0,0,0,k4*Izz];
end
